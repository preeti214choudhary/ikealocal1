(window.webpackJsonpRecentlyViewed=window.webpackJsonpRecentlyViewed||[]).push([[4],{105:function(e,t,n){"use strict";n.r(t);function o(e,t){var r=JSON.parse(localStorage.getItem("ikeaBrowserHistory")||"{}");if(!r[e])return[];var n=r[e];return n.reverse(),n.filter(function(e){return!(e.missing&&!function(e){return e+6048e5<Date.now()}(e.missing))}).map(function(e){return e.id}).filter(function(e){return e!==t}).slice(0,12)}function i(t){var e=JSON.parse(localStorage.getItem("ikeaBrowserHistory"));!function(e){localStorage.setItem("ikeaBrowserHistory",JSON.stringify(e))}({plp:e.plp,pip:e.pip.map(function(e){return t===e.id?Object.assign({},e,{missing:Date.now()}):e})})}var s=n(11),r=n(13),c=n.n(r),a=n(14),p=n.n(a),l=n(28),u=n.n(l),d=n(29),m=n.n(d),f=n(30),b=n.n(f),h=Object({baseUrl:"https://www.ikea.com",locale:"en-GB",siteFolder:"gb/en",categoriesAPIUrl:"https://rec.ingka.com/services/gb-prod/categories/%category_id%/en",addToCartAPIUrl:"https://rec.ingka.com/services/gb-prod/items/addtocart",popularAPIUrl:"https://rec.ingka.com/services/fr-prod/items/popular/",styleAPIUrl:"https://rec.ingka.com/services/fr-prod/items/style",easyPickersAPIUrl:"https://rec.ingka.com/services/fr-prod/items/easypick/",newProductsAPIUrl:"https://rec.ingka.com/services/fr-prod/items/new/",btiProductsAPIUrl:"https://rec.ingka.com/services/fr-prod/items/bti/",similarAPIUrl:"https://rec.ingka.com/services/fr-prod/items",cartPageUrl:"https://order.ikea.com/gb/en/checkout/shoppingbag/",enableContextualImages:!1,siteKey:"gben-production",enableCartRecommendations:!0,enablePopularRecommendations:!1,enableRevampComponents:!1,enableRecentlyViewedSPALink:!0,loadAllModules:!1}),g=h.baseUrl,y=h.siteFolder,v=function(t){var e=t.substr(t.length-3),r="".concat(g,"/").concat(y,"/products/").concat(e,"/").concat(t,".json");return fetch(r,{method:"GET",mode:"cors"}).then(function(e){if(e.ok)return e;throw new Error("Network response error.")}).then(function(e){return e.json()}).then(function(e){if(Object.keys(e).length)return e;throw new Error("Empty response object.")}).catch(function(e){throw i(t),new Error(e)})},k=function(e,t){return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype?(function(e,r){new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(r(),t.unobserve(e.target),t.disconnect())})},{root:null,rootMargin:"0px 0px 300px 0px",threshold:0}).observe(e)}(e,t),!0):(t(),!1)},w=Object({baseUrl:"https://www.ikea.com",locale:"en-GB",siteFolder:"gb/en",categoriesAPIUrl:"https://rec.ingka.com/services/gb-prod/categories/%category_id%/en",addToCartAPIUrl:"https://rec.ingka.com/services/gb-prod/items/addtocart",popularAPIUrl:"https://rec.ingka.com/services/fr-prod/items/popular/",styleAPIUrl:"https://rec.ingka.com/services/fr-prod/items/style",easyPickersAPIUrl:"https://rec.ingka.com/services/fr-prod/items/easypick/",newProductsAPIUrl:"https://rec.ingka.com/services/fr-prod/items/new/",btiProductsAPIUrl:"https://rec.ingka.com/services/fr-prod/items/bti/",similarAPIUrl:"https://rec.ingka.com/services/fr-prod/items",cartPageUrl:"https://order.ikea.com/gb/en/checkout/shoppingbag/",enableContextualImages:!1,siteKey:"gben-production",enableCartRecommendations:!0,enablePopularRecommendations:!1,enableRevampComponents:!1,enableRecentlyViewedSPALink:!0,loadAllModules:!1}).enableRevampComponents,P=function(e){function r(e){var t;return c()(this,r),(t=u()(this,m()(r).call(this,e))).state={history:[],hasHistory:!0,contentModule:null,isIntersected:!1},t}return b()(r,e),p()(r,[{key:"componentDidMount",value:function(){var t=this;w?Promise.all([n.e(0),n.e(11)]).then(n.bind(null,102)).then(function(e){t.setState({contentModule:e.default})}):Promise.all([n.e(9),n.e(10)]).then(n.bind(null,103)).then(function(e){t.setState({contentModule:e.default})}),k(this.ref,function(){t.getHistory(),t.setState({isIntersected:!0})})}},{key:"getHistory",value:function(){var e=this,t=o("pip",this.props.productId),r=[],n=t.map(function(e,t){return v(e).then(function(e){return r[t]=e})});if(0!==n.length)return Promise.all(n.map(function(e){return e.catch(function(e){return e})})).then(function(){return e.setState({history:r.filter(function(e){return e&&e.mainImage&&e.mainImage.id}),hasHistory:!0})});this.setState({hasHistory:!1})}},{key:"render",value:function(){var t=this;if(this.state.hasHistory){var e=this.state.contentModule;return Object(s.h)("div",{ref:function(e){t.ref=e}},e&&0<this.state.history.length&&Object(s.h)(e,{history:this.state.history,isIntersected:this.state.isIntersected,slideIndex:0}))}}}]),r}(s.a),I=n(16);n.d(t,"run",function(){return S});var U=Object({baseUrl:"https://www.ikea.com",locale:"en-GB",siteFolder:"gb/en",categoriesAPIUrl:"https://rec.ingka.com/services/gb-prod/categories/%category_id%/en",addToCartAPIUrl:"https://rec.ingka.com/services/gb-prod/items/addtocart",popularAPIUrl:"https://rec.ingka.com/services/fr-prod/items/popular/",styleAPIUrl:"https://rec.ingka.com/services/fr-prod/items/style",easyPickersAPIUrl:"https://rec.ingka.com/services/fr-prod/items/easypick/",newProductsAPIUrl:"https://rec.ingka.com/services/fr-prod/items/new/",btiProductsAPIUrl:"https://rec.ingka.com/services/fr-prod/items/bti/",similarAPIUrl:"https://rec.ingka.com/services/fr-prod/items",cartPageUrl:"https://order.ikea.com/gb/en/checkout/shoppingbag/",enableContextualImages:!1,siteKey:"gben-production",enableCartRecommendations:!0,enablePopularRecommendations:!1,enableRevampComponents:!1,enableRecentlyViewedSPALink:!0,loadAllModules:!1}).enableRevampComponents,A=document.querySelector("[data-recently-viewed]"),S=function(){var e="undefined"!=typeof ikea&&void 0!==ikea.cookieConsent,t=e&&ikea.cookieConsent.hasConsent(3);if(!e||t){var r=Object(I.b)();if(!U||I.a===Object(I.b)()){var n=document.querySelector("#section-recently-viewed"),o=document.querySelector(".js-product-pip[data-product-id]"),i=(o?o.dataset:{productId:0}).productId;A&&""!==r&&null===n&&Object(s.k)(Object(s.h)(P,{pageType:r,productId:i}),A)}}}},28:function(e,t,r){var n=r(32),o=r(31);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t}},29:function(t,e){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}t.exports=r},30:function(e,t,r){var n=r(33);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},31:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},32:function(t,e){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?t.exports=n=function(e){return r(e)}:t.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},n(e)}t.exports=n},33:function(r,e){function n(e,t){return r.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}r.exports=n}}]);
//# sourceMappingURL=recently-viewed.5de7a6e0.js.map